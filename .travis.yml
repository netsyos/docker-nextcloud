language: php
php:
- '7.0'
env:
  global:
  - COMMIT=${TRAVIS_COMMIT::8}
  - secure: gAnNkWp6uDtPXXGA0cTE8X2LG1i0z0ZQ4VufkdLEaitNctNbFNzNmy+7nKX1fb0PLHBcv4duk9GUNIOLUwKpZD/DCu3xw2Iq5NmdbzccElhcY1suIEoVZB9mRa++wBghRrWdHfS5iX3OqpJB/HFS0hoaNxUWf9gORAZVCTdb0hm/+UtOW/S2L0HXBtIYahz4D7dXOFItFzUcAJePMxwFtfVFuEezZ5Q1RyZfWnbeVZY8vkHBNnwZ7pnAOKbcGPnwS1tDG2VkUURtNZEMdaSFeyokJPbkueeIfNQo/Rj4wFjkV+7A2s2ZiiWYBIiCLnELgN7s3YHv2DzOlSSs8MCyTNJ+N//KhTOjLyR/0lNcWsUPd8nuQ8kB+AL+/1szMhfjftiWfIgVYa1CfVAllWZTFmnrBeFOogIhzc+sNnmInYPgLLUg7wqWMfGqG+XwsCjGsdVIB4C24B6w/NLP7EVw0DN3iS48guNuKcxKVtKxn0Ozk8zgGhCCMHgwJHs7Qb9WU3qhlZBSGQq2tWFh1AO5hXoiD3SFP8WrKGURqEsV9Kso1DjMhBaVN/QAbnP+cepcqeKc6vpPUvjHmpPTklSWcvRcTcP8hA+9FIO/U2z5HGyJ4o9WZRgmUUS4cTlKcMoLc2SJLi1XKuC6hLoDxymMXWhR88OCexSDDmElmOD6CMM=
  - secure: oDi/zKqQVhdXE3QpV5DPxVeR3VjkUzMkxbgUIW8tyvRHpQj6arFD3yHb6Fviu2AWQF+HGQZ0xV8WHxX41y7WAQFJ7kqwVyissxLOJfMBZkL+1snM5EvdPhXOo3v7ULmA3FUGoDv0efto8XMWvKDmM1pgaY9db49HlN2XkGp5+9Cg1V+njYPZO2yyF9B1+VxEB73xKvurOsJDTZnY+lfExOgLFDg2tVnLGLhl0aT6bmF0SsMolzrX0YKnhNdaVeZVUsqGXu5LPg8/I2gpGCSHxeofLj36wA0alKorOssCIqsP+gWcuas+SU5D9kFOrX3ZNGIbzSNN0oHeM8idDuN8DYY7wBB8JzYML67oihebGA/amQuulFUKM0LouDDabOn5rO2hUgNt7Y0JAYpdz5YiDiULIK5VPiZbVZoBo65r7j1ZGVzlmIxcm9FAD1kTHRGlQe6yvd3PoXAXgduqRYvgfdL3/tuA5NEu7FEStA3co0/MweCzWnZDMcHFFI7dHT1Yt+saQuVGFZFJK49CVnd6XRZmHzUseInnk68JS3xvAYZLaG/vaU8U8hT7w8P5TySv5ugvNMZI5ZuI9bJZGXWsbgQcZ2wShu2tU6/d+AoFIMbNhBpW/pZXj3AT/EkbfSB+ffDF+D9U4hXVcW0EXI/d4n+GfWCjgXEdqjNoCYYMwUs=
  - secure: BM9x+X9zrYmWGoJgcqNvlgoApfsBFQtO7vxf+X+goh4GotxN52p2+LKeFXNVaPZynokMyspHtg6xyjjtP/N1c6+N+KUEkY6o8jkyjfFzO+zJiuqHZiqngi8c6p6Aeihem/CPvyfzM96alxGZhJSEPvquzPAZOxH1nf97x74sl2VZIxgWilGTRunt47WUNAp6BbG6EU4YoPJ1u7s1qdGezJUk+lflZJOT9QU4nNvOx34JkirRULdXozvSLhOAwjyqNLi8wFGUXyy6cOwD1A7MAabl9i+0vjCph3dekkH0kS977VgCFLFxfrGmeOUC9l7hIoQ+avW1ewqwOsXES1DzfiaFoois+Uj3EiyODikq/QwbELQGljxRaHMYYniXapsRA1eG8qWjRyz8PTtqQ+J8QnLxvAvh+pkdF6i23JpzKL34K8omkbl53XqR+yjwlTDnTt7Gf+SqoZQAVKs04ot43WjqPZRblmm8djx+Qp90q4gbX5bxYgBvTsuSGCFmTH+JasLpvjOr9SWoos5aNtW76DQcnAKre86n/EIxYr3sLhoZ37EbrWptzPP5JUwAQ7xzcZmBz4hezB8hCVGwA7s3FPMNd+AaUihYSjOG1cGn5hLzLxCLO48CT86cprTobXHulPL3a5ABl4Luxt/pKStjGs3ynHrMul13kYQsm6Tc3bs=
script:
- ls -alh
- docker login -u $DOCKER_USER -p $DOCKER_PASS
- export REPO=netsyos/nextcloud
- export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH;
  fi`
- docker build -f Dockerfile -t $REPO:$COMMIT .
- docker tag $REPO:$COMMIT $REPO:$TAG
- docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
- docker push $REPO
after_success:
- date
notifications:
  slack:
    secure: P150bCOxleN8Qkl/0HatlNTlktnA4Iwdfq7qmfkavlMxY9Hv7ACgK+vK5XUVes60pO1NkuzgTrvwr8CBs8JS3i6y6bV05ehhR6eaDnRwZIDZ3/iuM9F4Jfh4JttUd5rfOlGXT4k8CLf/F7c93PAmThvM7SnUbVEQXRX4dtYm4TPrVcOVesLk2wUW+BkzeElXMsuHTlfycYBjpdaf2IqVIFC9FETsDT6ijKE6/BH9W22a+hCdnplDOpHkJyQLKpGO3MI+NccuJAjO1qhIRD7CLISlikOsIL6081hYy6ok1s/bQsth7FlHXlMd99QbIFBoBA8NSHY/1hwURE8o+tPrufdn5xvVw46cOdnztNv76K5uJTYWCIwVrma9mwvUcbUN5//bBYNHiDsooL5t0sSmx6AXOOshm/LX0EJBxI/NGbkLep8Ho3MpVR/A/K9NeECsHRuc254VtilXEcdS1fxMAX94UD7SvJ7pfaK3go1++/cYfwjXJ1LTXrL8+E9c/IoGm6EFePoutDkNi4+s0+H57T5Ww7hZHUh4jCvbSED3V+zqlF4cfj2+iPb0UuAiM2yVQ5Q0Trt1QEmeOOCf2bUbj1W0S+sVwKFjEsrPltiyz3HkXf5Fh/Bo7SMVQ2Sj7i+eQp1d+kX0B/b5VmkFQc5Lc9RCbMWvbocCHhYh0HpASko=
